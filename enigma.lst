100 REM ENIGMA CHIFFRIERMASCHINE110 GOSUB 10000:REM WALZEN LESEN190 BLOCK 5200 GOSUB 11000:REM ZEICHEN HOLEN210 GOSUB 13000:REM ZEICHEN ERSETZEN220 GOSUB 12000:REM ZEICHEN AUSGEBEN300 GOTO 2009000 REM BEENDEN DER ENIGMA9010 BLOCK 09999 END10000 REM WALZEN EINLESEN NACH WA$() RA$() UND W10010 OPEN 1,8,2,"WALZEN1.TXT,R,P"10020 DIM WA$(11),RA$(11),AL$(11)10025 AL$="ABCDEFGHIJKLMNOPQRSTUVWXYZ"10026 TA$="PQAYWSXEDCRFVTGBZHNUJMIKLO"10030 W=010040 REPEAT10050 INPUT#1,W$,CO$,RA$10060 IF CO$<>"" THEN WA$(W)=CO$:RA$(W)=RA$:AL$(W)=AL$:W=W+110070 UNTIL ST<>010080 W=W-110090 CLOSE 110130 PRINT"WALZEN EINGELESEN"CHR$(13)10140 RETURN11000 REM ZEICHEN EINLESEN IN K$11005 POKE 204,0:REM CURSOR EIN11010 REPEAT11020 GET K$11030 IF K$="!" THEN POKE 204,1:PRINT" ":GOTO 900011040 K$=FILTER$(K$,$81)11050 UNTIL K$<>""11060 POKE 204,1:REM CURSOR AUS11070 RETURN12000 REM ZEICHEN AUSGEBEN Z$12010 PRINT Z$;12020 RETURN13000 REM ZEICHEN UEBERSETZEN K$ NACH Z$13005 GOSUB 14000:REM WEITERSCHALTEN13010 Z$=SUBST$(K$,TA$,AL$)13020 Z$=SUBST$(Z$,AL$,WA$(0))13029 Z$=SUBST$(Z$,AL$(1),AL$)13030 Z$=SUBST$(Z$,AL$,WA$(1))13031 Z$=SUBST$(Z$,AL$,AL$(1))13039 Z$=SUBST$(Z$,AL$(2),AL$)13040 Z$=SUBST$(Z$,AL$,WA$(2))13041 Z$=SUBST$(Z$,AL$,AL$(2))13049 Z$=SUBST$(Z$,AL$(3),AL$)13050 Z$=SUBST$(Z$,AL$,WA$(3))13051 Z$=SUBST$(Z$,AL$,AL$(3))13060 Z$=SUBST$(Z$,AL$,WA$(10))13069 Z$=SUBST$(Z$,AL$(3),AL$)13070 Z$=SUBST$(Z$,WA$(3),AL$)13071 Z$=SUBST$(Z$,AL$,AL$(3))13079 Z$=SUBST$(Z$,AL$(2),AL$)13080 Z$=SUBST$(Z$,WA$(2),AL$)13081 Z$=SUBST$(Z$,AL$,AL$(2))13089 Z$=SUBST$(Z$,AL$(1),AL$)13090 Z$=SUBST$(Z$,WA$(1),AL$)13091 Z$=SUBST$(Z$,AL$,AL$(1))13100 Z$=SUBST$(Z$,AL$,TA$)13200 RETURN14000 REM WALZEN WEITERSCHALTEN14020 REM WA$(1)=ROTATE$(WA$(1),1)14030 AL$(1)=ROTATE$(AL$(1),25)14040 FOR W=1 TO 214050 FOR I=1 TO LEN(RA$(W))14060 IF MID$(RA$(W),I,1)<>LEFT$(AL$(W),1) THEN 1409014070 REM WA$(W+1)=ROTATE$(WA$(W+1),1)14080 AL$(W+1)=ROTATE$(AL$(W+1),25)14090 NEXT I14100 NEXT W14110 RETURN
READY.
